
{% extends "base.html" %}

{% block headers %}
    <div class="card-header-tabs card-body" >
        <h1>
        <u>Register a Driver</u>
        </h1>
    </div>

{% endblock %}

{% block page_content %}
    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <div class="card-body">
        <script>
            $(document).ready(function(){
                $('#id_name').autocomplete({
                    source: function(request, response) {
                        $.ajax({
                            url: "https://v1.formula-1.api-sports.io/drivers",
                            dataType: "json",
                            data: {
                                search: request.term
                            },
                            headers: {
                                "x-rapidapi-key": "d5c9a1dac197da1fdb1873a7d4b49afa",
                                "x-rapidapi-host": "v1.formula-1.api-sports.io"
                         
                            },
                            success: function(data){
                                response( $.map( data.response, function(item){
                            
                                    return{
                                        id: item.id,
                                        value: item.name,
                                        img : item.image,
                                        nationality : item.nationality,
                                        birthdate : item.birthdate,
                                        teams : item.teams
                                    }
                            
                                }));
                            }
                        });
                    },
                    minLength:3,
                    select: function(event, ui ) {
                        if(ui.item){
                            $("#id_name").val(ui.item.name);
                            $("#id_img").val(ui.item.img);
                            $("#id_nationality").val(ui.item.nationality);
                            $("#id_birthdate").val(ui.item.birthdate);
                            $("#id_teams").val(ui.item.teams);
                        }
                    }
                });
            });

        </script>

        <form method="post" enctype="multipart/form-data" action="">
            {% csrf_token %}
            <table>
                {{ form.as_table }}
            </table>
            <p></p>
            <input type="submit" value="Submit"/>  
        </form>
    </div>
{% endblock %}